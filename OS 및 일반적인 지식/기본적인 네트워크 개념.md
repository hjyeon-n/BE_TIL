# 기본적인 네트워크 개념

### 네트워크🎇

쉽게 말해서 컴퓨터와 컴퓨터를 연결해주는 망을 뜻한다.

네트워크를 구축하려면 컴퓨터 간의 연결 규격인 프로토콜이 필요. 

<br/>

### 1. TCP/IP

: 하드웨어, 운영체제, 접속매체와 관계없이 동작할 수 있는 개방형 구조로 대표적인 프로토콜.

- TCP(Transmission Control Protocol)
  : 하단의 IP 프로토콜을 사용하여 신뢰성 있는 데이터 전송 서비스를 제공하는 프로토콜 혹은 소프트웨어 기술

  ✔ 데이터의 흐름 관리, 데이터 정확성 확인 등의 역할 수행

  

- IP (Internet Protocol)
  : 두 종단 간의 패킷 전달을 책임짐

  ✔ 데이터(패킷)를 목적지까지 전송하는 역할을 담당

  

<br/>

- TCP/IP의 계층

  - 응용 계층
    : WWW, FTP, Telnet, SMTP와 같은 네트워크 프로그램으로 구성

  - 전송계층
    : 각 시스템을 연결하고 TCP 프로토콜을 이용하여 데이터를 전송

  - 인터넷 계층
    : IP 프로토콜을 이용하여 데이터를 정의하고 경로를 배정

  - 물리 계층
    : 실제 네트워크를 접근할 수 있도록 하는 물리적인 부분

<br/>

- 혼잡제어와 흐름제어

  - 혼잡제어
    : 송신 측의 데이터 전달과 네트워크의 데이터 처리 속도 차이를 해결하기 위한 기법

    ![image](https://user-images.githubusercontent.com/62419307/89727572-2b381500-da61-11ea-9aab-8d83cd3f2906.png)

    - AIMD 
      1. 처음에 패킷을 하나씩 보내고 이것이 문제없이 도착하면 창 크기(단위 시간 내에 보내는 패킷의 수)를 1씩 증가시켜가면서 전송하는 방법이다. 
      2. 만일 패킷 전송을 실패하거나 일정한 시간을 넘으면 패킷을 보내는 속도를 절반으로 줄이게 된다.
      3. 문제점은 초기에 네트워크의 높은 대역폭을 사용하지 못하여 오랜 시간이 걸리게 되고, 네트워크가 혼잡해지는 상황을 미리 감지하지는 못한다.
    - Slow Start
      1. AIMD 방식과 마찬가지로 패킷을 하나씩 보내는 것부터 시작한다. 그러나 이 방식은 패킷이 문제없이 도착하면 각각의 ACK 패킷마다 창 크기를 1씩 늘린다. 즉, 한 주기가 지나면 창 크기가 2배로 된다.
      2. 혼잡 현상이 발생하면 창 크기를 1로 떨어뜨린다. 
      3. 처음에는 네트워크의 수용량을 예상할 수 있는 정보가 없지만 한번 혼잡 현상이 발생하고 나면 네트워크의 수용량을 어느 정도 예상할 수 있으므로 혼잡 현상이 발생하였던 창 크기의 절반까지는 이전처럼 지수 함수 꼴로 창 크기를 증가시키고 그 이후부터는 완만하게 1씩 증가시킨다.
    - Fast Retransmit
      1. 패킷을 받는 쪽에서 먼저 도착해야 할 패킷이 도착하지 않고 다음 패킷이 도착한 경우에도 ACK 패킷을 보낸다. 단, 순서대로 잘 도착한 마지막 패킷의 다음 패킷의 순번을 ACK 패킷에 실어서 보낸다.
      2. 중간에 패킷하나가 손실되게 되면 송신 측에서는 순번이 중복된 ACK 패킷을 받게 되고, 이것을 감지하는 순간 문제가 되는 순번의 패킷을 재전송해 줄 수 있다. 
      3. 빠른 재전송은 중복된 순번의 패킷을 3개 받으면 재전송을 한다. 또한 이런 현상이 일어나는 것은 약간 혼잡한 상황이 일어난 것이므로 혼잡을 감지하고 창 크기를 줄이게 된다.
    - Fast Recovery
      1. 잡한 상태가 되면 창 크기를 1로 줄이지 않고 반으로 줄이고 선형 증가시키는 방법이다.
      2. 빠른 회복 정책까지 적용하면 혼잡 상황을 한번 겪고 나서부터는 AIMD 방식으로 동작한다.

    

    

  - 흐름제어
    : 송신측과 수신측의 데이터 처리 속도 차이를 해결하기 위한 기법

    - Stop and Wait : 매번 전송한 패킷에 대해 확인 응답을 받아야만 그 다음 패킷을 전송하는 방법.
    - 수신측에서 설정한 윈도우 크기만큼 송신 측에서 확인 응답없이 세그먼트를 전송할 수 있게 하여 데이터 흐름을 동적으로 조절하는 제어기법

  

<br/>

- 3way handshaking 연결 과정

  : TCP의 정확한 데이터 전송을 위해 연결을 설정하는 과정

  ![image](https://user-images.githubusercontent.com/62419307/89727294-2160e280-da5e-11ea-98dd-f6aee5efa245.png)

  - 클라이언트가 서버에게 SYN 패킷을 보낸다. (sequence : x)

  - 서버가 SYN(x)을 받고, 클라이언트에게 수신했다는 신호인 ACK와 SYN 패킷을 보낸다.  (sequence : y,  ACK : x + 1)

  - 클라이언트는 서버의 응답인 ACK(x+1)와 SYN(y) 패킷을 받고, ACK(y+1)를 서버로 보낸다.

    

- 4way handshaking 

  : TCP의 정확한 데이터 전송을 위해 연결을 해제하는 과정
  

  ![image](https://user-images.githubusercontent.com/62419307/89727321-756bc700-da5e-11ea-8b6d-424a8fc84fb5.png)

  - 클라이언트가 서버에게 연결을 종료한다는 FIN 플래그를 보낸다.
  - 서버는 FIN을 받고, 확인했다는 ACK를 클라이언트에게 보낸다. (이때 모든 데이터를 보내기 위해 TIME OUT 상태가 된다)
  - 데이터를 모두 보냈다면, 연결이 종료되었다는 FIN 플래그를 클라이언트에게 보낸다.
  - 클라이언트는 FIN을 받고, 확인했다는 ACK를 서버에게 보낸다. (아직 서버로부터 받지 못한 데이터가 있을 수 있으므로 TIME_WAIT을 통해 기다린다.)

  - 서버는 ACK를 받은 이후 소켓을 닫는다 (Closed)
  - TIME_WAIT 시간이 끝나면 클라이언트도 닫는다 (Closed)

  

<br/>

### 2. UDP

- 최소의 서비스 모델을 가진 간단한 전송 프로토콜. 
- 비연결형이므로 두 프로세스가 통신하기 전 핸드셰이킹을 하지 않는다.  
- 흐름제어와 혼잡제어를 제공하지 않아 데이터 손실 위험이 TCP보다 크다.
- 속도가 빨라 실시간 스트리밍 등 데이터 손실이 크게 중요하지 않고 빠른 속도가 요구되는 서비스에서 사용한다.

<br/>

### ➕ OSI 7계층

![image](https://user-images.githubusercontent.com/62419307/89727416-94b72400-da5f-11ea-9001-6499f84a6d64.png)

- 애플리케이션 계층
  : 네트워크 애플리케이션과 애플리케이션 계층 프로토콜이 있는 곳

  🌼 HTTP, SMTP, FTP

  ✔ 패킷 이름: 메시지

  <br/>

- 프레젠테이션 계층
  : 데이터 표현에 대한 독립성을 제공하고 암호화하는 역할 담당

  🌼 JPEG, MPEG

  <br/>

- 세션 계층
  : 데이터가 통신하기 위한 논리적 연결을 담당

  🌼 API, Socket

  <br/>

- 트랜스포트 계층
  : 클라이언트와 서버 간에 애플리케이션 계층 메시지를 전송하는 서비스를 제공

  🌼 TCP, UDP

  ✔ 패킷 이름: 세그먼트

  <br/>

- 네트워크 계층
  : 한 호스트에서 다른 호스트로 라우터를 통해 이동할 경로를 선택하여 IP 주소를 지정하고, 해당 경로에 따라 패킷을 전달한다.

  🌼 IP, ICMP

  ✔ 패킷 이름: 데이터그램

  <br/>

- 링크 계층
  : 물리 계층을 통해 송수신되는 데이터의 오류와 흐름을 관리하여 안전하게 데이터를 전송할 수 있도록 도와주는 역할

  🌼 Switch, Bridge

  ✔ 패킷 이름: 프레임

  <br/>

- 물리계층
  : 데이터를 전송하는 역할만 수행

  🌼 Hubs



[참고1](https://gyoogle.dev/blog/computer-science/network/TCP%203%20way%20handshake%20&%204%20way%20handshake.html)

[참고2](https://ko.wikipedia.org/wiki/%ED%98%BC%EC%9E%A1_%EC%A0%9C%EC%96%B4)

[이미지 출처](https://velog.io/@devzunky/TIL-no.89-Network-The-7-Layers-of-the-OSI-Model)