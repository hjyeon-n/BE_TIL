# 스레드와 동시성 🤹‍♀️

### 스레드 🦾

: 프로세스 안에서 실행되는 여러 흐름 단위를 말하며, 문맥 교환이 용이하지 않은 자원들을 공유한다.

- 메모리 및 일부 주변 장치는 문맥 교환에 과다한 시간 소비

- 한 프로세스에서 다른 프로세스로 제어가 넘어가면 자원이 바뀌므로 다시 초기화

  

### 스레드 장점 👍

- 사용자에 대한 응답성 증가
- 자원과 메모리 공유 가능: IPC 프로그램이 용이
- 경제성: 자원 할당 개수를 줄이고 문맥교환 오버헤드 줄임
- 다중 프로세서 구조 활용 가능



### 단일 스레드와 멀티 스레드 🙋‍♀️👪

- 단일 스레드 프로세스: 프로세스 하나에 스레드 하나만을 지원
- 멀티 스레드 프로세스: 프로세스 하나에 2개 이상의 스레드를 지원

✔ 모든 스레드는 프로세스의 자원과 상태를 공유, 같은 주소 공간에 존재하며 동일한 데이터에 접근

![single_multi](https://user-images.githubusercontent.com/62419307/89294657-c9f7f680-d69a-11ea-80dd-213bb368e354.png)



### 프로세스와 스레드 비교 🤼‍♂️

[참고](https://gyoogle.dev/blog/computer-science/operating-system/Process%20vs%20Thread.html)

**프로세스** : 프로그램을 메모리 상에서 실행중인 작업

**스레드** : 프로세스 안에서 실행되는 여러 흐름 단위

1. 프로세스

   - 메모리에 독립적인 공간을 가짐

     - 텍스트 (코드): 프로세스가 실행하는 코드 저장
     - 데이터 (정적 변수): 프로세스 실행 중에 할당받는 영역. 전역 또는 정적 변수 저장
     - 실행 스택 (Stack): 호출된 프로시저의 복귀 주소와 지역 변수 등의 일시적인 데이터를 저장하는 영역
     - 실행 힙(Heap): 텍스트(코드) 영역과는 별도로 유지되는 자유 영역

     ![image](https://user-images.githubusercontent.com/62419307/89296627-8ce13380-d69d-11ea-9868-6b32df1fe0b6.png)

     <br>

   - 멀티 프로세스

     **장점** 🙂: 메모리 침범 문제를 os에서 해결하기 때문에 안정적

     **단점** 🙁: 독립된 메모리 영역을 갖고 있어, 작업량이 많을 수록 오버헤드 발생, Context Switching으로 인한 성능 저하

   <br>

2. 스레드

   - 다른 스레드와 자원, 공간을 공유
   - 멀티 스레드

     **장점** 🙂: 프로세스에 비해 공유 메모리만큼의 시간과 자원 손실이 감소, 전역 변수와 정적 변수에 대한 자료 공유 가능

     **단점** 🙁: 안전성 문제, 공유 메모리이기 때문에 하나의 스레드가 데이터 공간 망가뜨리면, 모든 스레드가 작동 불능



### 동시성 문제 😧

[참고](https://gyoogle.dev/blog/computer-language/Java/Thread.html)

**스레드 동기화 방법**

- 임계 영역(critical section) : 공유 자원에 단 하나의 스레드만 접근하도록 함 (하나의 프로세스에 속한 스레드만 가능)
- 뮤텍스(mutex) : 공유 자원에 단 하나의 스레드만 접근하도록 함(서로 다른 프로세스에 속한 스레드도 가능)
- 이벤트(event) : 특정한 사건 발생을 다른 스레드에게 알림
- 세마포어(semaphore) : 한정된 개수의 자원을 여러 스레드가 사용하려고 할 때 접근 제한
- 대기 가능 타이머(waitable timer) : 특정 시간이 되면 대기 중이던 스레드 깨움





