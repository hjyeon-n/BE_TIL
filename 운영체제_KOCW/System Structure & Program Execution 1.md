# System Structure & Program Execution 1

### μ»΄ν“¨ν„° μ‹μ¤ν…μ κµ¬μ΅° π–¥

μ»΄ν“¨ν„° μ‹μ¤ν…μ κµ¬μ΅°λ” ν¬κ² μ»΄ν“¨ν„° λ‚΄λ¶€μ¥μΉμ™€ μ»΄ν“¨ν„° μ™Έλ¶€ μ¥μΉλ΅ κµ¬μ„±ν•  μ μλ‹¤. 

+ μ…λ ¥: μ»΄ν“¨ν„° λ‚΄λ¶€λ΅ λ°μ΄ν„°κ°€ λ“¤μ–΄μ¤λ” κ²ƒ
+ μ¶λ ¥: μ»΄ν“¨ν„° μ™Έλ¶€μ¥μΉλ΅ λ°μ΄ν„°κ°€ λ‚κ°€λ” κ²ƒ

λ©”λ¨λ¦¬ λ° μ…μ¶λ ¥ μ¥μΉ λ“±μ ν•λ“μ›¨μ–΄ μ¥μΉμ—λ” **μ»¨νΈλ΅¤λ¬**κ°€ μλ‹¤. μ»¨νΈλ΅¤λ¬λ” μΌμΆ…μ μ‘μ€ CPUλ΅μ„, μ¥μΉλ“¤μ„ μ μ–΄ν•λ” μ—­ν• μ„ ν•λ‹¤.

ex) λ””μ¤ν¬ μ»¨νΈλ΅¤λ¬: λ””μ¤ν¬μ ν—¤λ“λ¥Ό μ›€μ§μ΄κ³  μ–΄λ–¤ λ°μ΄ν„°λ¥Ό μ½μ„μ§€ μ μ–΄ν•λ‹¤.

CPUμ™€ disk μ†λ„ μ°¨μ΄κ°€ ν¬κΈ° λ•λ¬Έμ— μ»¨νΈλ΅¤λ¬λ¥Ό μ‚¬μ©ν•΄ μ¥μΉλ¥Ό μ μ–΄ν•λ‹¤κ³  μƒκ°ν•λ©΄ λλ‹¤! π

![image](https://user-images.githubusercontent.com/62419307/98951558-bed82080-253d-11eb-82c3-2a2c4b19b353.png)

<br>

### CPU μ—°μ‚°κ³Ό I/Oμ—°μ‚°

π™‹β€β™€οΈCPU... λ‚΄κ°€ κ±”λ¥Ό μ μ•„λ”λ° μ»΄ν“¨ν„°μ λ‘λ‡λΌλ©°?! λΌκ³  μƒκ°ν–λ‹¤λ©΄ λ°μ€ λ§κ³  λ°μ€ ν‹€λ¦¬λ‹¤! π¤“

λΉ λ¥Έ μ†λ„λ΅ μ²λ¦¬ν•λ” κ³„μ‚° λ¥λ ¥μ€ μμ§€λ§, μΈκ°„μ λ‘λ‡μ²λΌ μ¤μ¤λ΅ νλ‹¨μ„ λ‚΄λ¦¬μ§„ λ»ν•λ‹¤. π‘€

μ¦‰, **CPUλ” λ§¤ μ‹μ  λ©”λ¨λ¦¬μ νΉμ • μ£Όμ†μ— μ΅΄μ¬ν•λ” λ…λ Ήμ„ ν•λ‚μ”© μ½μ–΄μ™€ μ‹¤ν–‰ν•  λΏμ΄λ‹¤!** μ΄λ•, CPUκ°€ μν–‰ν•΄μ•Ό ν•  λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό λ‹΄κ³  μλ” λ μ§€μ¤ν„°λ¥Ό ν”„λ΅κ·Έλ¨ μΉ΄μ΄ν„°(Program Counter: PC)λΌκ³  ν•λ‹¤.

κ·Έλ¬λ©΄ μ»΄ν“¨ν„° μ‹μ¤ν…μ λ™μ‘μ΄ CPUμ— μν•΄μ„λ§ μ΄λ£¨μ–΄μ§κΉ? κ·Έλ΄λ“― ν•μ§€λ§ μ•„λ‹λ‹¤. λ””μ¤ν¬μ—μ„ νμΌμ„ μ½μ–΄μ¤κΈ°λ„ ν•κ³  ν‚¤λ³΄λ“λ΅ μ…λ ¥μ„ λ°›κΈ°λ„ ν•λ‹¤. λ”°λΌμ„ μ»΄ν“¨ν„° μ‹μ¤ν… λ™μ‘μ„ μ΄ν•΄ν•κΈ° μ„ν•΄μ„λ” μ „μ²΄μ μΈ μ‹μ¤ν… κµ¬μ΅°λ¥Ό λ¨Όμ € νμ•…ν•΄μ•Ό ν•λ‹¤.

![image](https://user-images.githubusercontent.com/62419307/98953839-87b73e80-2540-11eb-8fd4-20358c20ce81.png)



μ΄μ „μ— μ„¤λ…ν–λ“―, μ…μ¶λ ¥ μ¥μΉλ³„λ΅ μ‘μ€ CPUμ™€ λ©”λ¨λ¦¬κ°€ μλ”λ° μ΄λ¥Ό κ°κ° **μ…μ¶λ ¥ μ»¨νΈλ΅¤λ¬**μ™€ **λ΅μ»¬λ²„νΌ**λΌκ³  λ¶€λ¥Έλ‹¤. λ”°λΌμ„, μ…μ¶λ ¥ μ¥μΉλ“¤μ I/O μ—°μ‚°μ€ μ…μ¶λ ¥ μ»¨νΈλ΅¤λ¬κ°€ λ‹΄λ‹Ήν•κ³ , μ»΄ν“¨ν„° λ‚΄μ—μ„ μν–‰λλ” μ—°μ‚°μ€ λ©”μΈ CPUκ°€ λ‹΄λ‹Ήν•λ‹¤. μ΄λ•, μ…μ¶λ ¥ μ¥μΉμ™€ λ©”μΈ CPUλ” κ°κ°μ μΌμ΄ λ‹¤λ¥Έ κ³³μ—μ„ λ°μƒν•λ―€λ΅ λ™μ‹ μν–‰μ΄ κ°€λ¥ν•λ‹¤. 

<br>

#### κ·Έλ¬λ©΄ μ–΄λ–»κ² μν–‰μ΄ λλ” κ±°μ•Ό? π¤·β€β™€οΈ

1. ν”„λ΅κ·Έλ¨ Aκ°€ μν–‰ μ¤‘μ— λ””μ¤ν¬μ—μ„ λ°μ΄ν„°λ¥Ό μ½μ–΄μ¤λΌλ” λ…λ Ήμ„ λ‚΄λ¦°λ‹¤.
2. λ””μ¤ν¬ μ»¨νΈλ΅¤λ¬κ°€ λ¬Όλ¦¬μ μΈ λ””μ¤ν¬μ—μ„ λ‚΄μ©μ„ μ½μ–΄ μ΄λ¥Ό λ΅μ»¬λ²„νΌμ— μ €μ¥ν•λ‹¤.
3. μ›ν•λ” λ°μ΄ν„°λ¥Ό λ΅μ»¬λ²„νΌλ΅ λ‹¤ μ½μ–΄μ¤κ³  λ‚λ©΄ Bλ” λ©”μΈ CPUμ—μ„ λ‹¤μ μΌμ„ μν–‰ν•  μ μλ‹¤.

μ΄ κ³Όμ •μ„ CPUκ°€ λ‹¤ μ§€μΌ λ³΄κ³  μμ„κΉ? μ•„λ‹λ‹¤!π™…β€β™€οΈ CPUλ” μΌλ§ μ‹μΌλ†“κ³  λ‹¤λ¥Έ μΌμ„ μν–‰ μ¤‘μ΄λ‹¤. κ·Έλ ‡κΈ° λ•λ¬Έμ— μ‚¬μ©μ μ…μ¥μ—μ„λ” interactiveν•κ² μ›€μ§μΌ μ μλ‹¤. λ§μ•½ I/O λ“± μ‘μ—…μ΄ λλ‚λ©΄, **μ¥μΉμ— μλ” μ»¨νΈλ΅¤λ¬κ°€ μΈν„°λ½νΈλ¥Ό λ°μƒμ‹μΌ CPUμ— λ³΄κ³ ν•λ‹¤.** 

CPU μ†μ—λ” **μΈν„°λ½νΈ λΌμΈ(interrupt line)**μ΄ μμ–΄μ„ λ…λ Ή ν•λ‚λ¥Ό μν–‰ν•  λ•λ§λ‹¤ μΈν„°λ½νΈκ°€ λ°μƒν–λ”μ§€ ν™•μΈν•κ³ , μΈν„°λ½νΈκ°€ λ°μƒν–μΌλ©΄ λ‹¤μ λ…λ Ήμ„ μν–‰ν•κΈ° μ „μ— μΈν„°λ½νΈ μ²λ¦¬λ¥Ό ν•κ² λλ‹¤.

<br>

### μΈν„°λ½νΈμ μΌλ°μ  κΈ°λ¥

μ΄μ  μΈν„°λ½νΈκ°€ λ¬΄μ—‡μ΄κ³  λ¬΄μ¨ μΌμ„ ν•λ”μ§€μ— λ€ν•΄ μ•μ•„λ³΄μ.π”

μ΄μμ²΄μ  μ»¤λ„μ—λ” μΈν„°λ½νΈκ°€ λ“¤μ–΄μ™”μ„ λ• ν•΄μ•Ό ν•  μΌμ΄ λ―Έλ¦¬ λ‹¤ ν”„λ΅κ·Έλλ°λμ–΄ κ·Έ μ½”λ“κ°€ λ³΄κ΄€λΌ μλ‹¤. 

μ•μ μμ²λΌ λ””μ¤ν¬ μ»¨νΈλ΅¤λ¬κ°€ μΈν„°λ½νΈλ¥Ό λ°μƒμ‹ν‚¤λ©΄ CPUλ” ν•λ μΌμ„ μ μ‹ λ©μ¶”κ³ , μΈν„°λ½νΈκ°€ λ°μƒν–μ„ λ• μν–‰ν•λ„λ΅ μ •μλ μ½”λ“λ¥Ό μ°Ύμ•„μ„ μν–‰ν•λ‹¤. 

μ΄ μΈν„°λ½νΈμ—λ” **ν•λ“μ›¨μ–΄ μΈν„°λ½νΈ**μ™€ **μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈ**κ°€ μλ‹¤. μΈν„°λ½νΈ λ°μƒ μ—¬λ¶€λ¥Ό μ•λ¦¬λ” κ²ƒμ€ λ™μΌν•μ§€λ§ ν•λ“μ›¨μ–΄ μΈν„°λ½νΈλ” μ»¨νΈλ΅¤λ¬ λ“± ν•λ“μ›¨μ–΄ μ¥μΉκ°€ μΈν„°λ½νΈ λΌμΈμ„ μ„Έν…ν•λ” λ°λ©΄μ— μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈλ” μ†ν”„νΈμ›¨μ–΄κ°€ κ·Έ μΌμ„ μν–‰ν•λ‹¤λ” μ°¨μ΄μ μ΄ μλ‹¤.

1. μΈν„°λ½νΈκ°€ λ°μƒν•λ©΄, CPUλ” ν•λ μΌμ„ λ¨Έλ¬΄κ³  μ΄μμ²΄μ  μ»¤λ„ λ‚΄μ—μ„ ν•΄λ‹Ή μΈν„°λ½νΈμ μ²λ¦¬λ¥Ό μ„ν•΄ μ •μλ μ½”λ“λ¥Ό μ°Ύκ² λλ‹¤.
2. μ΄μμ²΄μ λ” μ΄μ²λΌ ν•  μΌμ„ μ‰½κ² μ°Ύμ•„κ°€κΈ° μ„ν•΄ **μΈν„°λ½νΈ λ²΅ν„°(interrupt vector)**λ¥Ό κ°€μ§€κ³  μλ‹¤. 
3. **μΈν„°λ½νΈ μ²λ¦¬λ£¨ν‹΄**μ„ ν†µν•΄ ν•΄λ‹Ή μΈν„°λ½νΈ μ²λ¦¬λ¥Ό μ™„λ£ν•κ³ , μ›λ μν–‰ν•λ μ‘μ—…μΌλ΅ λμ•„κ°€μ•Ό ν•λ―€λ΅ μΈν„°λ½νΈ μ²λ¦¬ μ „ μ§„ν–‰ μ¤‘μ΄λ μ‘μ—…μ΄ λ¬΄μ—‡μ΄μ—λ”μ§€ λ°λ“μ‹ μ €μ¥ν•΄μ•Ό ν•λ‹¤. μ΄μμ²΄μ λ” μ΄λ¬ν• μ •λ³΄λ¥Ό μ €μ¥ν•κΈ° μ„ν• μ¥μ†λ¥Ό λ³„λ„λ΅ κ°€μ§€κ³  μλ‹¤.

β• μ©μ–΄ μ •λ¦¬

+ **μΈν„°λ½νΈ λ²΅ν„°** 

  μΈν„°λ½νΈ μΆ…λ¥λ§λ‹¤ λ²νΈλ¥Ό μ •ν•΄μ„, λ²νΈμ— λ”°λΌ μ²λ¦¬ν•΄μ•Ό ν•  μ½”λ“κ°€ μ„μΉν• λ¶€λ¶„μ„ κ°€λ¦¬ν‚¤κ³  μλ” μλ£κµ¬μ΅°

  β†’ μΈν„°λ½νΈλ§λ‹¤ λ¬΄μ¨ μΌμ„ ν•λ”μ§€ μ• μ μλ‹¤.

+ **μΈν„°λ½νΈ μ²λ¦¬λ£¨ν‹΄**

  **μΈν„°λ½νΈ ν•Έλ“¤λ¬(interrupt handler)**λΌκ³ λ„ λ¶λ¦¬λ©°, μ‹¤μ  μ²λ¦¬ν•΄μ•Ό ν•  μ½”λ“λ¥Ό λ§ν•λ‹¤.

<br>

#### μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈμ™€ ν•λ“μ›¨μ–΄ μΈν„°λ½νΈμ— λ€ν•΄μ„ λ” μ•λ ¤μ¤„λ? π¤”

μΌλ°μ μΌλ΅ μΈν„°λ½νΈλΌκ³  ν•λ©΄ ν•λ“μ›¨μ–΄ μΈν„°λ½νΈλ¥Ό μλ―Έν•κ³ , μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈλ” **νΈλ©(trap)π§€**μ΄λΌλ” μ©μ–΄λ΅ μ£Όλ΅ λ¶λ¦°λ‹¤.

μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈμ μλ΅λ” **μμ™Έμƒν™©(exception)**κ³Ό **μ‹μ¤ν… μ½(system call)**μ΄ μλ‹¤.

+ μμ™Έμƒν™©

  μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ΄ 0μΌλ΅ λ‚λ„λ” μ—°μ‚° λ“± λΉ„μ •μƒμ μΈ μ‘μ—…μ„ μ‹λ„ν•κ±°λ‚, μμ‹ μ λ©”λ¨λ¦¬ μμ—­ λ°”κΉ¥μ— μ ‘κ·Όν•λ ¤λ” μ‹λ„ λ“± κ¶ν•μ΄ μ—†λ” μ‘μ—…μ„ μ‹λ„ν•  λ• μ΄μ— λ€ν• μ²λ¦¬λ¥Ό μ„ν•΄ λ°μƒμ‹ν‚¤λ” μΈν„°λ½νΈμ΄λ‹¤.

+ μ‹μ¤ν… μ½

  μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ΄ μ΄μμ²΄μ  λ‚΄λ¶€μ— μ •μλ μ½”λ“λ¥Ό μ‹¤ν–‰ν•κ³  μ‹¶μ„ λ• μ΄μμ²΄μ μ— μ„λΉ„μ¤λ¥Ό μ”μ²­ν•λ” λ°©λ²•μ΄λ‹¤.

  **π¤― μ—¥? μ΄μμ²΄μ μ— μ”μ²­κΉμ§€ ν•΄μ•Ό ν•΄?**

  ~~λ“¤μ–΄μ¬ λ•λ” μμ μ§€λ§, λ‚κ° λ•λ” μ•„λ‹λ€λ‹¤.~~

  μ΄μμ²΄μ κ°€ ν”„λ΅κ·Έλ¨μ—κ² CPU μ μ–΄κ¶μ„ λ¶€μ—¬ν•  λ•λ” μμ λ΅­μ§€λ§, ν• λ² λ„μ–΄κ°€λ©΄ λΊμ„ μ μ—†λ‹¤. CPUλ” μ΄λ―Έ λ„μ–΄κ°”κΈ° λ•λ¬Έμ΄λ‹¤.

  κ·Έλμ„ μ΄μμ²΄μ  μ»¤λ„μ— μλ” μ½”λ“λ¥Ό μν–‰ν•  λ•λ” μΈν„°λ½νΈ λΌμΈ μ„Έν…μ„ ν†µν•΄ λ‹¤μ‹ μ΄μμ²΄μ μ—κ² μ μ–΄κ¶μ„ λ„κ²¨μ¤μ•Ό ν•λ‹¤. 

  μ΄λ” CPUμ νΉκ¶λ…λ Ήκ³Ό μΌλ°λ…λ Ήμ μ°¨μ΄μ™€λ„ κ΄€λ ¨μ΄ μλ‹¤.

<br>

### CPUμ modebit

μ°λ¦¬κ°€ ν”ν μ‚¬μ©ν•λ” μ΄μμ²΄μ λ” μ—¬λ¬ ν”„λ΅κ·Έλ¨μ΄ λ™μ‹μ— μ‹¤ν–‰λ  μ μλ” λ‹¤μ¤‘ ν”„λ΅κ·Έλλ° ν™κ²½μ—μ„ λ™μ‘ν•λ‹¤. κ·Έλ¬λ―€λ΅ μ¶©λμ΄λ‚ λ‹¤λ¥Έ ν”„λ΅κ·Έλ¨ μ‹¤ν–‰ λ°©ν•΄λ¥Ό λ§‰κΈ° μ„ν•΄ **μ»¤λ„λ¨λ“(0)**μ™€ **μ‚¬μ©μλ¨λ“(1)**λ΅ CPU λ‚΄λ¶€μ— modebitλ¥Ό κµ¬λ¶„ν•΄μ„ λ‘ κ°€μ§€ λ¨λ“λ¥Ό μ§€μ›ν•λ‹¤.

λ§μ•½, μ–΄λ–¤ ν”„λ΅κ·Έλ¨μ΄ μ΄μƒν• λ…λ Ήμ„ μν–‰μ‹μΌ λ‹¤λ¥Έ ν”„λ΅κ·Έλ¨μ λ©”λ¨λ¦¬ μμ—­μ΄λ‚ νμΌ μμ—­μ„ μΉ¨λ²”ν•  μ μλ‹¤. λ”°λΌμ„ μ΄λ¬ν• μ—°μ‚°μ€ μ»¤λ„λ¨λ“μ—μ„λ§ μ‹¤ν–‰ν•κ² ν•μ—¬ λ³΄μ•μ„±μ„ ν™•λ³΄ν•λ‹¤. μ΄λ¥Ό μ„ν•΄ CPUλ” λ³΄μ•κ³Ό κ΄€λ ¨λ λ…λ Ήμ„ μν–‰ν•κΈ° μ „, λ¨λ“λΉ„νΈλ¥Ό ν™•μΈν•λ‹¤.

+ μ»¤λ„λ¨λ“

  μ΄μμ²΄μ κ°€ CPUμ μ μ–΄κ¶μ„ κ°€μ§€κ³  μ΄μμ²΄μ  μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ” λ¨λ“λ΅μ„, μ΄ λ¨λ“μ—μ„λ” λ¨λ“  μΆ…λ¥μ λ…λ Ήμ„ λ‹¤ μ‹¤ν–‰ν•  μ μλ‹¤.

  νΉν μ‹μ¤ν…μ λ³΄μ•κ³Ό κ΄€λ ¨λ λ…λ Ήλ“¤μ„ νΉκ¶λ…λ Ήμ΄λΌκ³  ν•λ©°, μ»¤λ„λ¨λ“μ—μ„λ§ μν–‰ν•  μ μλ‹¤.

+ μ‚¬μ©μλ¨λ“

  μ…μ¶λ ¥ κ°™μ΄ νΉκ¶λ…λ Ήμ΄ ν•„μ”ν•  λ•, μ‚¬μ©μ λ¨λ“λ” μν–‰μ΄ λ¶κ°€ν•λ―€λ΅ **μ‹μ¤ν… μ½**μ„ νΈμ¶ν•΄ μ΄μμ²΄μ μ— μ”μ²­ν•΄μ•Ό ν•λ‹¤. νΉκ¶λ…λ Ήμ΄ λμ΄ λ‚λ©΄, λ‹¤μ‹ CPUμ μ μ–΄κ¶μ„ μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ—κ² λ„κ²¨μ„ λ‹¤μ‹ μ‚¬μ©μ λ¨λ“λ΅ μ‚¬μ©ν•  μ μλ‹¤.

<br>

### DMA

μ›μΉ™μ μΌλ΅ λ©”λ¨λ¦¬λ” CPUμ— μν•΄μ„λ§ μ ‘κ·Όν•  μ μλ” μ¥μΉμ΄λ‹¤. λ”°λΌμ„ λ‹¤λ¥Έ μ¥μΉκ°€ λ©”λ¨λ¦¬μ λ°μ΄ν„°μ— μ ‘κ·Όν•κΈ° μ„ν•΄μ„λ” CPUμ—κ² μΈν„°λ½νΈλ¥Ό λ°μƒμ‹μΌ CPUκ°€ μ΄λ¥Ό λ€ν–‰ν•λ” μ‹μΌλ΅λ§ κ°€λ¥ν•λ‹¤. ν•μ§€λ§ κ·Έλ¬λ”λ‹... μΈν„°λ½νΈκ°€ λ„λ¬΄ λ§μ•„μ„ CPU μ—…λ¬΄ ν¨μ¨μ„±μ΄ λ–¨μ–΄μ§„λ‹¤! π’ 

CPU π¤¬: μ• λκ² μ–΄... λ‚ λ§κ³  λ©”λ¨λ¦¬μ— μ ‘κ·Όμ΄ κ°€λ¥ν• μ¥μΉλ¥Ό λ”°λ΅ λ‘μ! 

λ°”λ΅ κ·Έ μΉκµ¬κ°€ **DMA**! DMAλ” μΌμΆ…μ μ»¨νΈλ΅¤λ¬λ΅μ„, CPUκ°€ μ…μ¶λ ¥ μ¥μΉλ“¤μ λ©”λ¨λ¦¬ μ ‘κ·Ό μ”μ²­μ— μν•΄ μμ£Ό μΈν„°λ½νΈ λ‹Ήν•λ” κ²ƒμ„ λ§‰μ•„μ£Όλ” μ—­ν• μ„ ν•λ‹¤. DMAλ¥Ό μ‚¬μ©ν•λ©΄ λ΅μ»¬λ²„νΌμ—μ„ λ©”λ¨λ¦¬λ΅ μ½μ–΄μ¤λ” μ‘μ—…μ„ CPUκ°€ λ‹΄λ‹Ήν•λ” κ²ƒμ΄ μ•„λ‹λΌ DMAκ°€ λ€ν–‰ν•¨μΌλ΅μ¨ CPU λ” μ›λ ν•λ μ‘μ—…μ„ λ©μ¶”κ³  μΈν„°λ½νΈλ¥Ό μ²λ¦¬ν•  ν•„μ”κ°€ μ—†μ–΄μ§„λ‹¤.

β• λ©”λ¨λ¦¬ μ»¨νΈλ΅¤λ¬μ™€λ” λ‹¤λ¥Έ μ¥μΉ!

: λ©”λ¨λ¦¬ μ»¨νΈλ΅¤λ¬λ” νΉμ • λ©”λ¨λ¦¬ μμ—­μ— λ™μ‹ μ ‘κ·Όν•  λ• μ μ–΄ν•λ” μ¥μΉμ΄λ‹¤.